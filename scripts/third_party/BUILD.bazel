load(
    "//third_party:load_utilities.bzl",
    "create_direct_import_dependency_wrappers",
    "create_maven_dependency_wrappers",
)
load(":versions.bzl", "DIRECT_REMOTE_DEPENDENCIES", "MAVEN_ARTIFACT_TREES")
load("//third_party/tools/moshi:plugin_setup.bzl", setUpMoshiPlugin = "setUp")

package_group(
    name = "script_all_artifact_visibility",
    includes = [
        ":script_test_artifact_visibility",
        "//:oppia_binary_visibility",
        "//scripts:oppia_script_library_visibility",
    ],
)

package_group(
    name = "script_test_artifact_visibility",
    includes = [
        "//scripts:oppia_script_test_visibility",
        "//scripts:oppia_script_testing_library_visibility",
    ],
)

create_maven_dependency_wrappers(
    direct_prod_dependencies = MAVEN_ARTIFACT_TREES["deps"]["prod"]["direct"],
    direct_test_dependencies = MAVEN_ARTIFACT_TREES["deps"]["test"]["direct"],
    maven_repository_name = "maven_scripts",
    prod_artifact_visibility = [":script_all_artifact_visibility"],
    test_artifact_visibility = [":script_test_artifact_visibility"],
)

create_direct_import_dependency_wrappers(
    dependency_imports_details = DIRECT_REMOTE_DEPENDENCIES,
    maven_artifact_visibility = ["@maven_scripts//:__pkg__"],
    prod_artifact_visibility = [":script_all_artifact_visibility"],
    test_artifact_visibility = [":script_test_artifact_visibility"],
)

setUpMoshiPlugin(
    name = "moshi",
    moshi_compiler_dep = "//scripts/third_party:com_squareup_moshi_moshi-kotlin-codegen",
    moshi_exported_library = "//scripts/third_party:com_squareup_moshi_moshi-kotlin",
    visibility = [":script_all_artifact_visibility"],
)
